<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GridView - Motorsport Data Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading { opacity: 0.5; }
        .card { transition: all 0.2s ease; }
        .card:hover { transform: translateY(-2px); }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <header class="border-b border-gray-800 py-6">
        <div class="container mx-auto px-4">
            <h1 class="text-3xl font-bold">üèÅ GridView</h1>
            <p class="text-gray-400 mt-1">All motorsport. One dashboard.</p>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <!-- Series Cards -->
        <section class="mb-12">
            <h2 class="text-xl font-semibold mb-4">Series</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                <div class="card bg-gray-800 rounded-lg p-4 text-center cursor-pointer" onclick="loadF1()">
                    <span class="text-3xl">üèéÔ∏è</span>
                    <h3 class="font-medium mt-2">F1</h3>
                    <span class="text-xs text-green-500">‚óè Live</span>
                </div>
                <div class="card bg-gray-800 rounded-lg p-4 text-center cursor-pointer" onclick="loadWRC()">
                    <span class="text-3xl">üåç</span>
                    <h3 class="font-medium mt-2">WRC</h3>
                    <span class="text-xs text-green-500">‚óè Live</span>
                </div>
                <div class="card bg-gray-800 rounded-lg p-4 text-center opacity-50">
                    <span class="text-3xl">üèÅ</span>
                    <h3 class="font-medium mt-2">NASCAR</h3>
                    <span class="text-xs text-yellow-500">‚óè Coming</span>
                </div>
                <div class="card bg-gray-800 rounded-lg p-4 text-center opacity-50">
                    <span class="text-3xl">üá∫üá∏</span>
                    <h3 class="font-medium mt-2">IndyCar</h3>
                    <span class="text-xs text-yellow-500">‚óè Coming</span>
                </div>
                <div class="card bg-gray-800 rounded-lg p-4 text-center opacity-50">
                    <span class="text-3xl">üéÆ</span>
                    <h3 class="font-medium mt-2">iRacing</h3>
                    <span class="text-xs text-yellow-500">‚óè Coming</span>
                </div>
                <div class="card bg-gray-800 rounded-lg p-4 text-center opacity-50">
                    <span class="text-3xl">üéÆ</span>
                    <h3 class="font-medium mt-2">ACC</h3>
                    <span class="text-xs text-yellow-500">‚óè Coming</span>
                </div>
            </div>
        </section>

        <!-- Data Display -->
        <section class="grid md:grid-cols-2 gap-8">
            <!-- F1 Section -->
            <div>
                <h2 class="text-xl font-semibold mb-4">üèéÔ∏è Formula 1</h2>
                <div id="f1-data" class="bg-gray-800 rounded-lg p-4">
                    <p class="text-gray-400">Click F1 card to load data...</p>
                </div>
            </div>
            
            <!-- WRC Section -->
            <div>
                <h2 class="text-xl font-semibold mb-4">üåç WRC</h2>
                <div id="wrc-data" class="bg-gray-800 rounded-lg p-4">
                    <p class="text-gray-400">Click WRC card to load data...</p>
                </div>
            </div>
        </section>

        <!-- API Status -->
        <section class="mt-12">
            <h2 class="text-xl font-semibold mb-4">API Status</h2>
            <div id="api-status" class="bg-gray-800 rounded-lg p-4">
                <p class="text-gray-400">Checking API status...</p>
            </div>
        </section>
    </main>

    <footer class="border-t border-gray-800 py-4 mt-12">
        <div class="container mx-auto px-4 text-center text-gray-500">
            <p>GridView ‚Ä¢ <a href="https://gridview.xyz" class="text-blue-400 hover:underline">gridview.xyz</a></p>
        </div>
    </footer>

    <script>
        // Check API health on load
        async function checkHealth() {
            const el = document.getElementById('api-status');
            try {
                const resp = await fetch('/api/health');
                const data = await resp.json();
                el.innerHTML = `
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                        <span class="font-medium">${data.status}</span>
                    </div>
                    <p class="text-gray-400 mt-2">Endpoints: ${data.endpoints.join(', ')}</p>
                `;
            } catch (e) {
                el.innerHTML = `<p class="text-red-400">API unavailable: ${e.message}</p>`;
            }
        }

        async function loadF1() {
            const el = document.getElementById('f1-data');
            el.innerHTML = '<p class="text-gray-400">Loading...</p>';
            el.classList.add('loading');
            
            try {
                const resp = await fetch('/api/f1/calendar');
                const data = await resp.json();
                
                let html = '<h3 class="font-semibold mb-3">2025 Calendar</h3>';
                html += '<div class="space-y-2 max-h-96 overflow-y-auto">';
                
                for (const race of data.events.slice(0, 10)) {
                    const date = race.date ? new Date(race.date).toLocaleDateString() : 'TBD';
                    html += `
                        <div class="flex justify-between items-center py-2 border-b border-gray-700">
                            <div>
                                <span class="font-medium">${race.name || 'Unknown'}</span>
                                <span class="text-gray-400 text-sm ml-2">${race.location || ''}</span>
                            </div>
                            <span class="text-gray-400 text-sm">${date}</span>
                        </div>
                    `;
                }
                
                html += '</div>';
                html += `<p class="text-gray-500 text-sm mt-4">Showing 10 of ${data.events.length} events</p>`;
                
                el.innerHTML = html;
            } catch (e) {
                el.innerHTML = `<p class="text-red-400">Error: ${e.message}</p>`;
            }
            
            el.classList.remove('loading');
        }

        async function loadWRC() {
            const el = document.getElementById('wrc-data');
            el.innerHTML = '<p class="text-gray-400">Loading...</p>';
            el.classList.add('loading');
            
            try {
                const resp = await fetch('/api/wrc/latest');
                const data = await resp.json();
                
                let html = `<h3 class="font-semibold mb-3">${data.event.name}</h3>`;
                html += `<p class="text-gray-400 text-sm mb-3">${data.event.location} ‚Ä¢ ${data.event.date}</p>`;
                html += '<div class="space-y-2">';
                
                for (const result of data.results) {
                    html += `
                        <div class="flex justify-between items-center py-2 border-b border-gray-700">
                            <div>
                                <span class="text-xl font-bold text-gray-500 mr-3">P${result.position}</span>
                                <span class="font-medium">${result.driver}</span>
                                <span class="text-gray-400 text-sm ml-2">${result.team}</span>
                            </div>
                            <span class="text-gray-400 font-mono">${result.time}</span>
                        </div>
                    `;
                }
                
                html += '</div>';
                if (data.note) {
                    html += `<p class="text-yellow-500 text-xs mt-4">‚ö†Ô∏è ${data.note}</p>`;
                }
                
                el.innerHTML = html;
            } catch (e) {
                el.innerHTML = `<p class="text-red-400">Error: ${e.message}</p>`;
            }
            
            el.classList.remove('loading');
        }

        // Init
        checkHealth();
    </script>
</body>
</html>
